# PostgreSQL Configuration for Docker - Unified Config

# Network and Connection Settings
listen_addresses = '*'
port = 5432
max_connections = 50

# Memory Settings
shared_buffers = 32MB
effective_cache_size = 128MB
maintenance_work_mem = 16MB
wal_buffers = 4MB
work_mem = 4MB

# Concurrency and Lock Settings
max_locks_per_transaction = 256
deadlock_timeout = 1s
lock_timeout = 30s
statement_timeout = 60s
idle_in_transaction_session_timeout = 300s

# Write-Ahead Logging (WAL)
wal_level = replica
max_wal_size = 1GB
min_wal_size = 80MB
wal_compression = on
checkpoint_completion_target = 0.9
checkpoint_timeout = 5min

# Logging Configuration (Optimized for Docker)
log_destination = 'stderr'
logging_collector = off
log_connections = off
log_disconnections = off
log_lock_waits = on
log_statement = 'none'
log_min_duration_statement = 5000
log_min_messages = warning
log_checkpoints = on
log_autovacuum_min_duration = 0

# Performance Tuning
random_page_cost = 1.1
effective_io_concurrency = 200
default_statistics_target = 100

# Autovacuum Settings
autovacuum = on
autovacuum_max_workers = 3
autovacuum_naptime = 1min
